---
title: "lab3_3"
output: html_document
date: "2022-12-12"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

1:
```{r, echo=FALSE}
library(neuralnet)
set.seed(1234567890)
Var <- runif(500, 0, 10)
mydata <- data.frame(Var, Sin=sin(Var))
tr <- mydata[1:25,] # Training
te <- mydata[26:500,] # Test
winit = runif(10, -1,1)

nn <- neuralnet(Sin ~ Var, data = tr,
                hidden = 10, startweights = winit)
# Plot of the training data (black), test data (blue), and predictions (red)
plot(tr, cex=2)
points(te, col = "blue", cex=1)
points(te[,1],predict(nn,te), col="red", cex=1)

```
The training data fits very well and the predictions seems pretty accurate aswell.

2:
```{r, echo=FALSE}
library(neuralnet)

# Set seed for reproducibility
set.seed(1234567890)

# Generate data
Var <- runif(500, 0, 10)
mydata <- data.frame(Var, Sin=sin(Var))
tr <- mydata[1:25,] # Training
te <- mydata[26:500,] # Test
winit = runif(10, -1,1)

# Define custom activation functions
h1 <- function(x) x
h2 <- function(x) ifelse(x>0,x,0)
h3 <- function(x) log(1 + exp(x))

# Train neural network with custom activation functions
nn1 <- neuralnet(Sin ~ Var, data = tr,
                hidden = 10, act.fct = h1, startweights = winit)

# Train neural network with custom activation functions
nn2 <- neuralnet(Sin ~ Var, data = tr,
                hidden = 10, act.fct = h2, startweights = winit)

# Train neural network with custom activation functions
nn3 <- neuralnet(Sin ~ Var, data = tr,
                hidden = 10, act.fct = h3, startweights = winit)

# Plot results
plot(tr, cex=3)
points(te, col = "blue", cex=2)
points(te[,1],predict(nn1,te), col="red", cex=1)
points(te[,1],predict(nn2,te), col="green", cex=1)
points(te[,1],predict(nn3,te), col="pink", cex=1)

```
The third custom activation seems to fit the best.

3:

```{r, echo=FALSE}
library(neuralnet)
set.seed(1234567890)
Var <- runif(500, 0, 50)
mydata <- data.frame(Var, Sin=sin(Var))


# Plot of the training data (black), test data (blue), and predictions (red)

plot(mydata, col = "blue", cex=1)
points(mydata[,1],predict(nn,mydata), col="red", cex=1)

```
The predictions seem to still be accurato to the data just not as large, something might be wrong.

5:

```{r, echo=FALSE}
library(neuralnet)
set.seed(1234567890)
Var <- runif(500, 0, 10)
Sin=sin(Var)
mydata <- data.frame( Var,  Sin)
test_data <- mydata


nn <- neuralnet(Sin ~ Var, data = test_data,
                hidden = 10, startweights = winit, threshold = 0.1 )

predictions <- predict(nn, test_data)

# Plot the training data, test data, and predictions
plot(mydata, col = "black", cex=1)
points(test_data, col = "blue", cex=1)
points(test_data[,1], predictions, col="red", cex=1)

```
ska få dåliga resultat, ser gjävlig bra ut nu något är fel!!

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
